(function(){var e,t,n;t=d3.time.format("%Y-%m-%d").parse,n=function(e,t){return"translate("+e+","+t+")"},e=137.508/180*Math.PI,app.timelineFocus=function(){var r,i,s,o,u,a,f;return u=null,a=960,s=200,r=[],f=d3.time.scale(),o=d3.scale.sqrt(),i=function(e){return u=e.each(function(i){var u,l,c,h;return f.domain(r).range([0,a]),c=f(d3.time.day.offset(r[0],1))-f.range()[0],h=d3.max(i,function(e){return e.values.length}),u=d3.scale.linear().domain([0,h]).range(["#fff","#f00"]),o.domain([0,h]).range([0,Math.min(s/2,c/2)]),l=e.selectAll(".group").data(i,function(e){return e.key}),l.enter().append("g").attr({"class":"group",transform:function(e){return n(f(d3.time.hour.offset(t(e.key),12)),s/2)}}).append("circle").attr({"class":"marker-sum",r:function(e){return o(e.values.length)}}),l.exit().remove()}),i},i.width=function(e){return arguments.length?(a=e,i):a},i.height=function(e){return arguments.length?(s=e,i):s},i.domain=function(e){var a;return arguments.length?(r=e,f.domain(r),a=f(d3.time.day.offset(r[0],1))-f.range()[0],o.range([0,Math.min(s/2,a/2)]),u!=null&&u.selectAll(".group").attr({transform:function(e){return n(f(t(e.key))+a/2,s/2)}}).select(".marker-sum").attr({r:function(e){return o(e.values.length)}}),i):r},i.brushstart=function(){var e;return e=d3.selectAll(".group.active").classed("active",!1),e.select(".marker-sum").transition().duration(100).attr("r",function(e){return o(e.values.length)}),e.selectAll(".detail").remove(),i},i.brushend=function(){var s,o;return o=d3.selectAll(".group").filter(function(e){var n;return n=d3.time.day(t(e.key)),d3.time.hour.offset(r[0],12).getTime()===n.getTime()}),o.classed("active",!0),o.select(".marker-sum").transition().duration(100).attr("r",0),s=o.selectAll(".detail").data(function(e){return e.values}),s.enter().append("circle").attr({"class":"detail",transform:function(t,r){var i,s,o;return s=r+1,i=s*e,o=8*Math.sqrt(s),n(Math.cos(i)*o,Math.sin(i)*o)},r:5}).style({opacity:0}),s.transition().duration(10).delay(function(e,t){return 100+t*1}).style({opacity:1}),i},i}}).call(this);